<!-- Loading State -->
@if (isLoading()) {
<section class="staff-members-section">
  <div class="container-fluid">
    <app-page-header
      [title]="'أعضاء هيئة التدريس والموظفون'"
      [breadcrumbs]="[
        { label: 'عن الكلية' },
        { label: 'أعضاء هيئة التدريس والموظفون' }
      ]"
    ></app-page-header>

    <div class="loading-container text-center py-5">
      <i
        class="pi pi-spin pi-spinner"
        style="font-size: 2rem; color: var(--primary-color)"
      ></i>
      <p class="mt-3">جاري تحميل البيانات...</p>
    </div>
  </div>
</section>
}

<!-- Staff Members Section -->
@if (!isLoading()) {
<section class="staff-members-section">
  <div class="container-fluid">
    <app-page-header
      [title]="'أعضاء هيئة التدريس والموظفون'"
      [breadcrumbs]="[
        { label: 'عن الكلية' },
        { label: 'أعضاء هيئة التدريس والموظفون' }
      ]"
    ></app-page-header>

    <!-- Filters Section -->
    <div class="filters-section">
      <div class="filters-container">
        <!-- Department Filter -->
        <div class="department-filter">
          <div class="filter-label">التصفية حسب التخصص:</div>
          <div class="department-buttons">
            <button
              class="dept-button"
              [class.active]="selectedDepartment() === 'all'"
              (click)="filterByDepartment('all')"
            >
              جميع التخصصات
            </button>
            @for (dept of departments(); track dept) {
            <button
              class="dept-button"
              [class.active]="selectedDepartment() === dept"
              [style.border-color]="getDepartmentColor(dept)"
              (click)="filterByDepartment(dept)"
            >
              {{ dept }}
            </button>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Staff Members Grid -->
    <div class="staff-grid">
      @if (filteredStaff().length !== members().length) {
      <div class="results-header">
        <div class="results-count">
          عرض {{ filteredStaff().length }} من أصل {{ members().length }} من
          أعضاء هيئة التدريس والموظفين
        </div>
      </div>
      }

      <div class="members-grid">
        @for (member of filteredStaff(); track member.id; let i = $index) {
        <div class="staff-card" [style.animation-delay.ms]="i * 100">
          <!-- Card Header -->
          <div class="card-header">
            <div class="member-avatar">
              <div
                class="avatar-circle"
                [style.background-color]="
                  getDepartmentColor(member.specialization || 'عام')
                "
              >
                @if (getMemberImage(member)) {
                <img [src]="getMemberImage(member)" [alt]="member.fullName" />
                } @else {
                <i class="pi pi-user"></i>
                }
              </div>
            </div>
            <div
              class="department-badge"
              [style.background-color]="
                getDepartmentColor(member.specialization || 'عام')
              "
            >
              {{ member.specialization || "عام" }}
            </div>
          </div>

          <!-- Card Body -->
          <div class="card-body">
            <h3 class="member-name">{{ member.fullName }}</h3>
            <p class="member-position">{{ member.position }}</p>
          </div>

          <!-- Card Footer -->
          <div class="card-footer">
            <div class="contact-info">
              <div class="phone-info">
                <i class="pi pi-send contact-icon"></i>
                <span class="phone-number">contact&#64;faculty.edu</span>
              </div>
            </div>
            <button
              class="call-button"
              (click)="sendEmail(member)"
              title="إرسال بريد إلكتروني إلى {{ member.fullName }}"
            >
              <i class="pi pi-send"></i>
              <span>إرسال بريد إلكتروني</span>
            </button>
          </div>
        </div>
        }
      </div>

      <!-- No Results Message -->
      @if (filteredStaff().length === 0) {
      <div class="no-results">
        <div class="no-results-icon">
          <i class="pi pi-search"></i>
        </div>
        <h3 class="no-results-title">
          لم يتم العثور على أعضاء هيئة تدريس أو موظفين
        </h3>
        <p class="no-results-text">حاول تعديل معايير البحث أو فلتر التخصص</p>
        <button class="reset-button" (click)="filterByDepartment('all')">
          <i class="pi pi-refresh"></i>
          إعادة تعيين الفلاتر
        </button>
      </div>
      }
    </div>
  </div>
</section>
}
